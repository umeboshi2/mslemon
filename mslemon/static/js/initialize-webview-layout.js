// Generated by CoffeeScript 1.6.3
(function() {
  $(document).ready(function() {
    var handle_teacup_field, layout, layout_content_retrieved, url, webview_id;
    url = document.URL;
    webview_id = url.replace(/^.*\/|\.[^.]*$/g, '');
    url = '/rest/webviews/' + webview_id;
    layout = {};
    handle_teacup_field = function(fieldname) {
      var field, html, template;
      field = TrumpetApp.LayoutModel.model.fields[fieldname];
      CoffeeScript.run(field.content);
      template = TrumpetApp.CurrentLayoutTemplate;
      html = template(field);
      TrumpetApp.CurrentLayoutTemplate = null;
      return html;
    };
    TrumpetApp.handle_teacup_field = handle_teacup_field;
    TrumpetApp.CurrentLayoutTemplate = null;
    layout_content_retrieved = function(data, status, xhr) {
      var html, template;
      if (status === 'success') {
        layout = data;
        TrumpetApp.LayoutModel = layout;
        window.WVlayout = layout;
        CoffeeScript.run(layout.template);
        template = TrumpetApp.LayoutTemplate;
        html = template(layout.model);
        return $('body').html(html);
      }
    };
    return $.get(url, {}, layout_content_retrieved);
  });

}).call(this);
