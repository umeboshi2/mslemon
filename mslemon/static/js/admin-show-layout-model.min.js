(function(){$(document).ready(function(){var b,j,i,r,k,h,p,q,n,f,d,a,l,o,e,m,c,g;l=teacup.renderable;i=teacup.div;n=teacup.i;c=teacup.strong;m=teacup.span;d=teacup.label;f=teacup.input;g=teacup.text;r=$(".editing-space");p=$(".field-list");b=$(".add-field-button");a=function(u,t){var s;s="/rest/admin/layoutmodels/"+u;s=s+"/fields/"+t;return s};q=l(function(s){return i(".btn.btn-default.btn-xs",function(){return g(s)})});k=l(function(s){return i({"field-id":s},"#edit-status",function(){g("Editing field");i("#save-content.action-button",function(){return g("Save")});i("#cancel-button.action-button.pull-right",function(){return g("Cancel")});return i("#field-editor")})});o=l(function(s){var t;t=".listview-entry.action-button.add-this-field";return i("#select-fields.listview-list",function(){var z,y,x,w,v,u;u=[];for(w=0,v=s.length;w<v;w++){x=s[w];y="#field-"+x.id;z=y+t;u.push(i(z,function(){return g(x.name)}))}return u})});h=function(s){$("#select-fields").remove();return window.location.reload()};e=function(t){var s,u;s=t.data;u=o(s);$(".header").append(u);return $(".add-this-field").click(function(){var A,y,z,w,B,x,v;A=$(this).attr("id");z=A.split("-");w=z[1];B=$("input[name=model_id]").val();$(".header").html(B+"-"+w);v="/rest/admin/layoutmodels/"+B;v=v+"/fields";y={field_id:w};return x=$.post(v,y,h,"json")})};j=function(t,E,B){var C,y,x,D,w,u,A,v,z,s;w=k(E);r.html(w);p.hide();b.hide();r.show();A=$("#save-content");A.hide();C=$("#cancel-button");C.click(function(){return window.location.reload()});x=ace.edit("field-editor");TrumpetApp.editor=x;z=x.getSession();z.on("change",function(){return A.show()});if(B==="html"){z.setMode("ace/mode/html")}else{if(B==="teacup"){z.setMode("ace/mode/coffee");z.setTabSize(4)}}x.setTheme("ace/theme/twilight");s=a(t,E);y=function(G,F,H){if(F==="success"){window.rdata=G;if(G.content!==null){return x.setValue(G.content)}}};u=$.get(s,{},y);D=function(G,F,H){if(F==="success"){A.hide()}TrumpetApp.rdata=G;TrumpetApp.rstatus=F;return TrumpetApp.rxhr=H};v=function(G,F,H){TrumpetApp.rdata=G;TrumpetApp.rstatus=F;TrumpetApp.rxhr=H;return TrumpetApp.make_alert("Error in save")};return A.click(function(){var F;F={update:"submit",content:x.getValue(),model_id:t,field_id:E};s="/rest/admin/layoutmodels/";s=s+t+"/fields/"+E;return $.ajax(s,{type:"PUT",data:F,success:D,error:v,dataType:"json"})})};b.click(function(){var u,t,s;u=$("input[name=model_id]").val();s="/rest/admin/layoutfields";return t=$.get(s,{},e,"json")});$(".edit-button").click(function(){var w,v,u,s,x,t;w=$(this).attr("id");v=w.split("-");u=v[1];x=$("input[name=model_id]").val();t=$(".header").text();s=$(this).attr("field-type");j(x,u,s);if(TrumpetApp.editor!==null){TrumpetApp.editor.destroy()}if(t==="Ms. Lemon"){return $(".header").html(q("FOoo-"+id))}else{return $(".header").html(q("Ms. Lemon"))}});$(".delete-button").click(function(){var v,w,y,z,A,u,t,x,s;t=$("input[name=model_id]").val();v=$(this).attr("id");y=v.split("-");u=y[1];z=u;x=$(".header").text();if(x==="Ms. Lemon"){$(".header").html(q("Delete-"+u))}else{$(".header").html(q("Ms. Lemon"))}A={update:"submit",model_id:t,field_id:z};s="/rest/admin/layoutmodels/";s=s+t+"/fields/"+z;w=function(C,B,D){return window.location.reload()};return $.ajax(s,{type:"DELETE",data:A,success:w,dataType:"json"})});return r.hide()})}).call(this);