(function(){$(document).ready(function(){var b,j,i,r,k,h,p,q,n,f,d,a,l,o,e,m,c,g;l=teacup.renderable;i=teacup.div;n=teacup.i;c=teacup.strong;m=teacup.span;d=teacup.label;f=teacup.input;g=teacup.text;r=$(".editing-space");p=$(".field-list");b=$(".add-field-button");a=function(u,t){var s;s="/rest/admin/layoutmodels/"+u;s=s+"/fields/"+t;return s};q=l(function(s){return i(".btn.btn-default.btn-xs",function(){return g(s)})});k=l(function(s){return i({"field-id":s},"#edit-status",function(){g("Editing field");i("#save-content.action-button",function(){return g("Save")});i("#keybinding.action-button",function(){return g("emacs")});i("#cancel-button.action-button.pull-right",function(){return g("Cancel")});return i("#field-editor")})});o=l(function(s){var t;t=".listview-entry.action-button.add-this-field";return i("#select-fields.listview-list",function(){var z,y,x,w,v,u;u=[];for(w=0,v=s.length;w<v;w++){x=s[w];y="#field-"+x.id;z=y+t;u.push(i(z,function(){return g(x.name)}))}return u})});h=function(s){$("#select-fields").remove();return window.location.reload()};e=function(t){var s,u;s=t.data;u=o(s);$(".header").append(u);return $(".add-this-field").click(function(){var A,y,z,w,B,x,v;A=$(this).attr("id");z=A.split("-");w=z[1];B=$("input[name=model_id]").val();$(".header").html(B+"-"+w);v="/rest/admin/layoutmodels/"+B;v=v+"/fields";y={field_id:w};return x=$.post(v,y,h,"json")})};j=function(t,G,D){var E,z,y,F,w,x,u,C,v,B,A,s;w=k(G);r.html(w);p.hide();b.hide();r.show();C=$("#save-content");C.hide();x=$("#keybinding");E=$("#cancel-button");E.click(function(){return window.location.reload()});A=TrumpetApp.functions.toggle_ace_keybinding;y=ace.edit("field-editor");TrumpetApp.editor=y;A(x,y);B=y.getSession();B.on("change",function(){return C.show()});if(D==="html"){B.setMode("ace/mode/html")}else{if(D==="teacup"){B.setMode("ace/mode/coffee");B.setTabSize(4)}}y.setTheme("ace/theme/trumpet");y.setKeyboardHandler("ace/keyboard/emacs");s=a(t,G);z=function(I,H,J){if(H==="success"){window.rdata=I;if(I.content!==null){y.setValue(I.content);return C.hide()}}};u=$.get(s,{},z);F=function(I,H,J){if(H==="success"){C.hide()}TrumpetApp.rdata=I;TrumpetApp.rstatus=H;return TrumpetApp.rxhr=J};v=function(I,H,J){TrumpetApp.rdata=I;TrumpetApp.rstatus=H;TrumpetApp.rxhr=J;return TrumpetApp.make_alert("Error in save")};return C.click(function(){var H;H={update:"submit",content:y.getValue(),model_id:t,field_id:G};s="/rest/admin/layoutmodels/";s=s+t+"/fields/"+G;return $.ajax(s,{type:"PUT",data:H,success:F,error:v,dataType:"json"})})};b.click(function(){var u,t,s;u=$("input[name=model_id]").val();s="/rest/admin/layoutfields";return t=$.get(s,{},e,"json")});$(".edit-button").click(function(){var w,v,u,s,x,t;w=$(this).attr("id");v=w.split("-");u=v[1];x=$("input[name=model_id]").val();t=$(".header").text();s=$(this).attr("field-type");j(x,u,s);if(TrumpetApp.editor!==null){TrumpetApp.editor.destroy()}if(t==="Ms. Lemon"){return $(".header").html(q("FOoo-"+id))}else{return $(".header").html(q("Ms. Lemon"))}});$(".delete-button").click(function(){var v,w,y,z,A,u,t,x,s;t=$("input[name=model_id]").val();v=$(this).attr("id");y=v.split("-");u=y[1];z=u;x=$(".header").text();if(x==="Ms. Lemon"){$(".header").html(q("Delete-"+u))}else{$(".header").html(q("Ms. Lemon"))}A={update:"submit",model_id:t,field_id:z};s="/rest/admin/layoutmodels/";s=s+t+"/fields/"+z;w=function(C,B,D){return window.location.reload()};return $.ajax(s,{type:"DELETE",data:A,success:w,dataType:"json"})});return r.hide()})}).call(this);