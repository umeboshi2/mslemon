(function(){var b={}.hasOwnProperty,c=function(g,e){for(var d in e){if(b.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g},a=function(d,e){return function(){return d.apply(e,arguments)}};jQuery(function(){var g,f,I,u,v,t,y,p,A,E,B,q,x,r,H,l,D,z,w,s,o,i,e,K,G,C,n,m,k,j,h,d,J,F;l=function(){return{user:H,group:y}};E=(function(M){c(L,M);function L(){s=L.__super__.constructor.apply(this,arguments);return s}L.prototype.routes={"":"home","view/:listview":"listview"};L.prototype.common=function(){var N;N=w;N.render();if(N.current_view!==null){return N.current_view.remove()}};L.prototype.home=function(){return this.common()};L.prototype.listview=function(O){var N,P;this.common();console.log("lview is "+O);N=l()[O];window.klass=N;P=new N;P.render({type:O});return w.current_view=P};return L})(Backbone.Router);q=(function(L){c(M,L);function M(){o=M.__super__.constructor.apply(this,arguments);return o}M.prototype.type=Backbone.HasMany;M.prototype.relatedModel="Group";M.prototype.collectionType="UserList";M.prototype.defaults={objtype:"user"};return M})(Supermodel.Model);v=(function(M){c(L,M);function L(){n=L.__super__.constructor.apply(this,arguments);return n}L.prototype.defaults={objtype:"group"};return L})(Backbone.RelationalModel);g=(function(M){c(L,M);function L(){m=L.__super__.constructor.apply(this,arguments);return m}L.prototype.parse=function(N){return N.data};return L})(Backbone.Collection);r=(function(M){c(L,M);function L(){k=L.__super__.constructor.apply(this,arguments);return k}L.prototype.model=q;L.prototype.url="/rest/users";return L})(g);t=(function(M){c(L,M);function L(){j=L.__super__.constructor.apply(this,arguments);return j}L.prototype.model=v;L.prototype.url="/rest/groups";L.prototype.parse=function(N){return N.data};return L})(g);z=function(L){var M,N;M=(function(P){c(O,P);function O(){N=O.__super__.constructor.apply(this,arguments);return N}O.prototype.model=v;O.prototype.url="/rest/users/"+L+"/groups";return O})(g);return new M};u=(function(L){c(M,L);function M(){h=M.__super__.constructor.apply(this,arguments);return h}M.prototype.template=TrumpetApp.admin_usrmgr_tmpl.entry;M.prototype.initialize=function(){_.bindAll(this,"render");this.model.bind("change",this.render);return this.model.bind("remove",this.unrender)};M.prototype.render=function(){var P,N,O;O=TrumpetApp.admin_usrmgr_tmpl;if(this.model.has("username")){N=O.user_entry}else{N=O.entry}P=N.render(this.model.attributes);this.$el.html(P);return this};M.prototype.unrender=function(){return $(this.el).remove()};M.prototype.events={"click .show-entry-btn":"showentry"};M.prototype.showentry=function(){var P,O,N;P=$(".listview-list");if(this.model.get("objtype")==="user"){N=new A}else{N=new p}O=N.render(this.model.attributes);return P.html(O)};return M})(Backbone.View);I=(function(M){c(L,M);function L(){d=L.__super__.constructor.apply(this,arguments);return d}L.prototype.el=$(".right-column-content");L.prototype.remove=function(){this.undelegateEvents();this.$el.empty();this.stopListening();return this.a};return L})(Backbone.View);A=(function(L){c(M,L);function M(){J=M.__super__.constructor.apply(this,arguments);return J}M.prototype.render=function(O){var N;N=TrumpetApp.admin_usrmgr_tmpl.main_user_view;this.$el.html(N.render(O));return this};return M})(I);p=(function(M){c(L,M);function L(){F=L.__super__.constructor.apply(this,arguments);return F}L.prototype.render=function(O){var N;N=TrumpetApp.admin_usrmgr_tmpl.main_group_view;this.$el.html(N.render(O));return this};return L})(I);f=(function(M){c(L,M);function L(){this.appendItem=a(this.appendItem,this);i=L.__super__.constructor.apply(this,arguments);return i}L.prototype.render=function(O){var N;N=TrumpetApp.admin_usrmgr_tmpl.listview;this.$el.html(N.render(O));return this};L.prototype.modelView=u;L.prototype.appendItem=function(O){var P,N;N=new this.modelView({model:O});P=N.render(O).el;return $(".listview-list").append(P)};L.prototype.events={"click .add-entry-btn":"new_entry_view"};L.prototype.new_entry_view=function(){var P,Q,O,N;Q=this.collection.model;O=new Q();N=TrumpetApp.admin_usrmgr_tmpl.create;P=N.render(O.attributes);return $(".listview-list").html(P)};return L})(I);H=(function(M){c(L,M);function L(){this.appendItem=a(this.appendItem,this);e=L.__super__.constructor.apply(this,arguments);return e}L.prototype.initialize=function(){console.log("Init UserListView");this.collection=new r;this.collection.bind("add",this.appendItem);return this.collection.fetch()};L.prototype.appendItem=function(O){var P,N;N=new this.modelView({model:O});window.mbview=N;P=N.render(O).el;return $(".listview-list").append(P)};return L})(f);y=(function(M){c(L,M);function L(){K=L.__super__.constructor.apply(this,arguments);return K}L.prototype.initialize=function(){console.log("Init GroupListView");this.collection=new t;this.collection.bind("add",this.appendItem);return this.collection.fetch()};return L})(f);x=(function(L){c(M,L);function M(){G=M.__super__.constructor.apply(this,arguments);return G}M.prototype.initialize=function(N){console.log("Init UserGroupListView");this.collection=z(N);this.collection.bind("add",this.appendItem);return this.collection.fetch()};return M})(Backbone.View);B=(function(M){var N;c(L,M);function L(){C=L.__super__.constructor.apply(this,arguments);return C}L.prototype.el=$(".sidebar");L.prototype.initialize=function(){return this.current_view=null};L.prototype.render=function(){var O;O=TrumpetApp.admin_usrmgr_tmpl.side_view;$(this.el).html(O.render());return this};N={trigger:true,replace:true};L.prototype.events={"click .home-button":function(){return D.navigate("",N)},"click .users-button":function(){$(".listview-list").remove();D.navigate("dummy",N);return D.navigate("view/user",N)},"click .groups-button":function(){$(".listview-list").remove();D.navigate("dummy",N);return D.navigate("view/group",N)}};return L})(Backbone.View);D=new E;w=new B;return Backbone.history.start()})}).call(this);