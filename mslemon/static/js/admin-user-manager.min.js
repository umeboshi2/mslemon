(function(){var b={}.hasOwnProperty,c=function(g,e){for(var d in e){if(b.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g},a=function(d,e){return function(){return d.apply(e,arguments)}};jQuery(function(){var j,A,x,L,f,y,u,d,s,t,C,v,G,w,e,r,z,h,B,E,D,F,q,N,M,K,J,I,H,p,o,n,m,l,k,i,g;z=function(){return{user:r,group:u}};B=function(){var O,P,Q;console.log("make_group_select_dlg");P='<div id="select-group-dialog"></div>';Q=$(".main-content");Q.append(P);O=$("#select-group-dialog");return O.dialog({dialogClass:"no-close",modal:true,buttons:{cancel:function(){return $(this).dialog("close")}}})};t=(function(P){c(O,P);function O(){F=O.__super__.constructor.apply(this,arguments);return F}O.prototype.routes={"":"home","view/:listview":"listview"};O.prototype.common=function(){var Q;Q=D;Q.render();if(Q.current_view!==null){return Q.current_view.remove()}};O.prototype.home=function(){return this.common()};O.prototype.listview=function(R){var Q,S;this.common();console.log("lview is "+R);Q=z()[R];window.klass=Q;S=new Q;S.render({type:R});return D.current_view=S};return O})(Backbone.Router);v=(function(O){c(P,O);function P(){q=P.__super__.constructor.apply(this,arguments);return q}P.prototype.type=Backbone.HasMany;P.prototype.relatedModel="Group";P.prototype.collectionType="UserList";P.prototype.defaults={objtype:"user"};return P})(Supermodel.Model);f=(function(P){c(O,P);function O(){p=O.__super__.constructor.apply(this,arguments);return p}O.prototype.defaults={objtype:"group"};return O})(Backbone.RelationalModel);j=(function(P){c(O,P);function O(){o=O.__super__.constructor.apply(this,arguments);return o}O.prototype.parse=function(Q){return Q.data};return O})(Backbone.Collection);e=(function(P){c(O,P);function O(){n=O.__super__.constructor.apply(this,arguments);return n}O.prototype.model=v;O.prototype.url="/rest/users";return O})(j);y=(function(P){c(O,P);function O(){m=O.__super__.constructor.apply(this,arguments);return m}O.prototype.model=f;O.prototype.url="/rest/groups";O.prototype.parse=function(Q){return Q.data};return O})(j);E=function(O){var P,Q;P=(function(S){c(R,S);function R(){Q=R.__super__.constructor.apply(this,arguments);return Q}R.prototype.model=f;R.prototype.url="/rest/users/"+O+"/groups";return R})(j);return new P};L=(function(O){c(P,O);function P(){l=P.__super__.constructor.apply(this,arguments);return l}P.prototype.template=TrumpetApp.admin_usrmgr_tmpl.entry;P.prototype.initialize=function(){_.bindAll(this,"render");this.model.bind("change",this.render);return this.model.bind("remove",this.unrender)};P.prototype.render=function(){var S,Q,R;R=TrumpetApp.admin_usrmgr_tmpl;if(this.model.has("username")){Q=R.user_entry}else{Q=R.entry}S=Q.render(this.model.attributes);this.$el.html(S);return this};P.prototype.unrender=function(){return $(this.el).remove()};P.prototype.events={"click .show-entry-btn":"showentry"};P.prototype.showentry=function(){var S,R,Q;S=$(".listview-list");if(this.model.get("objtype")==="user"){Q=new s({main_model:this.model})}else{Q=new d({main_model:this.model})}R=Q.render(this.model.attributes);return S.html(R)};return P})(Backbone.View);x=(function(P){c(O,P);function O(){k=O.__super__.constructor.apply(this,arguments);return k}O.prototype.el=$(".right-column-content");O.prototype.remove=function(){this.undelegateEvents();this.$el.empty();this.stopListening();return this};return O})(Backbone.View);s=(function(O){c(P,O);function P(){i=P.__super__.constructor.apply(this,arguments);return i}P.prototype.render=function(R){var Q,S;Q=TrumpetApp.admin_usrmgr_tmpl.main_user_view;this.$el.html(Q.render(R));S=new G(R);return this};return P})(x);d=(function(P){c(O,P);function O(){g=O.__super__.constructor.apply(this,arguments);return g}O.prototype.render=function(R){var Q;Q=TrumpetApp.admin_usrmgr_tmpl.main_group_view;this.$el.html(Q.render(R));return this};return O})(x);A=(function(P){c(O,P);function O(){this.appendItem=a(this.appendItem,this);N=O.__super__.constructor.apply(this,arguments);return N}O.prototype.render=function(R){var Q;Q=TrumpetApp.admin_usrmgr_tmpl.listview;this.$el.html(Q.render(R));return this};O.prototype.modelView=L;O.prototype.appendItem=function(R){var S,Q;Q=new this.modelView({model:R});S=Q.render(R).el;return $(".listview-list").append(S)};O.prototype.events={"click .add-entry-btn":"new_entry_view"};O.prototype.new_entry_view=function(){var S,T,R,Q;T=this.collection.model;R=new T();Q=TrumpetApp.admin_usrmgr_tmpl.create;S=Q.render(R.attributes);return $(".listview-list").html(S)};return O})(x);r=(function(P){c(O,P);function O(){this.appendItem=a(this.appendItem,this);M=O.__super__.constructor.apply(this,arguments);return M}O.prototype.initialize=function(){console.log("Init UserListView");this.collection=new e;this.collection.bind("add",this.appendItem);return this.collection.fetch()};O.prototype.appendItem=function(R){var S,Q;Q=new this.modelView({model:R});window.mbview=Q;S=Q.render(R).el;return $(".listview-list").append(S)};return O})(A);u=(function(P){c(O,P);function O(){K=O.__super__.constructor.apply(this,arguments);return K}O.prototype.initialize=function(){console.log("Init GroupListView");this.collection=new y;this.collection.bind("add",this.appendItem);return this.collection.fetch()};return O})(A);w=(function(O){c(P,O);function P(){J=P.__super__.constructor.apply(this,arguments);return J}P.prototype.template=TrumpetApp.admin_usrmgr_tmpl.entry;P.prototype.initialize=function(){_.bindAll(this,"render");this.model.bind("change",this.render);return this.model.bind("remove",this.unrender)};P.prototype.render=function(){var T,S,Q,R,U=this;R=TrumpetApp.admin_usrmgr_tmpl;Q=R.user_group_entry;window.tmpl=Q;S=Q.render(this.model.attributes);this.$el.html(S);T=$("#addgroup");T.click(function(){return U.add_group()});this.events;return this};P.prototype.unrender=function(){return $(this.el).remove()};P.prototype.events={"click #addgroup":"add_group"};P.prototype.add_group=function(){console.log("add_group");return B()};return P})(Backbone.View);G=(function(O){c(P,O);function P(){this.appendItem=a(this.appendItem,this);I=P.__super__.constructor.apply(this,arguments);return I}P.prototype.el=$(".user-group-list");P.prototype.initialize=function(Q){this.collection=E(Q.id);this.collection.bind("add",this.appendItem);return this.collection.fetch()};P.prototype.render=function(){var Q;Q="hello world";this.$el.html(Q);return this};P.prototype.oldrender=function(R){var Q;Q=TrumpetApp.admin_usrmgr_tmpl.listview;this.$el.html(Q.render(R));return this};P.prototype.modelView=w;P.prototype.appendItem=function(R){var S,Q;Q=new this.modelView({model:R});S=Q.render(R).el;return $(".user-group-list").append(S)};return P})(Backbone.View);C=(function(P){var Q;c(O,P);function O(){H=O.__super__.constructor.apply(this,arguments);return H}O.prototype.el=$(".sidebar");O.prototype.initialize=function(){return this.current_view=null};O.prototype.render=function(){var R;R=TrumpetApp.admin_usrmgr_tmpl.side_view;$(this.el).html(R.render());return this};Q={trigger:true,replace:true};O.prototype.events={"click .home-button":function(){return h.navigate("",Q)},"click .users-button":function(){$(".listview-list").remove();h.navigate("dummy",Q);return h.navigate("view/user",Q)},"click .groups-button":function(){$(".listview-list").remove();h.navigate("dummy",Q);return h.navigate("view/group",Q)}};return O})(Backbone.View);h=new t;D=new C;return Backbone.history.start()})}).call(this);