(function(){$(document).ready(function(){var b,j,m,i,r,k,p,q,o,g,f,c,l,n,e,h,a,d;l=teacup.renderable;i=teacup.div;o=teacup.i;e=teacup.strong;n=teacup.span;f=teacup.label;g=teacup.input;h=teacup.text;a=TrumpetApp.functions.url_join;r=$(".editing-space");p=$(".field-list");d=$("input[name=webview_id]").val();c=function(u,t){var s;s=a("/rest/admin/layoutmodels",u,"fields",t);return s};q=l(function(s){return i(".btn.btn-default.btn-xs",function(){return h(s)})});k=l(function(){i("#edit-status.listview-header",function(){h("Editing template");i("#save-content.action-button",function(){return h("Save")});i("#keybinding.action-button",function(){return h("emacs")});return i("#cancel-button.action-button.pull-right",function(){return h("Cancel")})});return i("#editor")});j=function(t){var w,D,z,y,E,x,u,C,v,B,A,s;x=k;r.html(x);r.show();C=$("#save-content");C.hide();D=$("#cancel-button");D.click(function(){return window.location.reload()});y=ace.edit("editor");TrumpetApp.editor=y;B=y.getSession();B.on("change",function(){return C.show()});B.setMode("ace/mode/coffee");B.setTabSize(4);y.setTheme("ace/theme/trumpet");y.setKeyboardHandler("ace/keyboard/emacs");w=$("#keybinding");A=TrumpetApp.functions.toggle_ace_keybinding;A(w,y);s=a("/rest/admin/webviews/",t);z=function(G,F,H){if(F==="success"){window.rdata=G;if(G.template!==null){y.setValue(G.template.content);return C.hide()}}};u=$.get(s,{},z);E=function(G,F,H){if(F==="success"){C.hide()}TrumpetApp.rdata=G;TrumpetApp.rstatus=F;return TrumpetApp.rxhr=H};v=function(G,F,H){TrumpetApp.rdata=G;TrumpetApp.rstatus=F;TrumpetApp.rxhr=H;return TrumpetApp.make_alert("Error in save")};return C.click(function(){var F;F={update:"submit",template:y.getValue()};s=a("/rest/admin/webviews",t);return $.ajax(s,{type:"PUT",data:JSON.stringify(F),success:E,error:v,dataType:"json"})})};b=function(u,w){var v,s,t;t=a("/rest/admin/webview",d,u);v=function(y,x,z){if(x==="success"){return window.location.reload()}};s={update:"submit"};if(u==="css"){s.css_id=w}else{s.js_id=w}return $.ajax(t,{type:"POST",data:JSON.stringify(s),success:v,dataType:"json"})};m=function(t,v){var u,s;s=a("/rest/admin/webview",d,t,v);u=function(x,w,y){if(w==="success"){return window.location.reload()}};return $.ajax(s,{type:"DELETE",data:{},success:u,dataType:"json"})};$(".edit-template").click(function(){return j(d)});$(".attach-css").click(function(){var v,u,t;t="css";u=$("select[name=css_id]");v=u.val();return b(t,v)});$(".attach-js").click(function(){var v,u,t;t="js";u=$("select[name=js_id]");v=u.val();return b(t,v)});$(".detach-css").click(function(){var t,s;s="css";t=$(this).attr("data");return m(s,t)});return $(".detach-js").click(function(){var t,s;s="js";t=$(this).attr("data");return m(s,t)})})}).call(this);