(function(){$(document).ready(function(){var g,b,d,c,a,f,e;$("#action-button-submit").hide();f=function(j,i,h){return $("header > h2").text(j.title)};a=function(h){if(h){$("#loading").show();return $(".fc-header").hide()}else{$("#loading").hide();return $(".fc-header").show()}};e=function(i,h){return h.css({"font-size":"0.7em",padding:"0.2em"})};d=function(){return alert("No events displayed")};b={title:"New Event",color:"#C26DB6",textColor:"black"};$("#newevent").data("eventObject",b);$("#newevent").draggable({zIndex:999,revert:true,revertDuration:0});g=function(k,l){var i,h,m,j;j=Date();if(j===j){h=$(this).data("eventObject");i=$.extend({},h);i.start=k;m=$("#newevent_input").val();i.title=m;i.allDay=l;$("#maincalendar").fullCalendar("renderEvent",i,true);$(this).remove();$("#newevent-container").remove();return $("#action-button-submit").toggle()}else{$(this).hide();return location.reload()}};$("#action-button-submit").click(function(){var h,n,m,k,i,p,o,l,j;$("#maincalendar").toggle();p=$("#maincalendar").fullCalendar("clientEvents");i=p[0];k=i.start.getTime();n=new Date();l=n.getTime();if(k<=l){alert("Event starts before now. Try again.");location.reload();return}o="yyyy-MM-dd HH:mm:ss";j=i.start;m=i.end;i.start=$("#maincalendar").fullCalendar("formatDate",j,o);i.end=$("#maincalendar").fullCalendar("formatDate",m,o);i.all_day=i.allDay;h=$("#add-event-url").val();return post_to_url(h,i,"post")});c=$("#event-source-url").val();return $("#maincalendar").fullCalendar({header:{left:"month, agendaWeek, agendaDay",center:"title"},theme:true,eventSources:[{url:c}],editable:true,droppable:true,drop:g,selectable:false,allDayDefault:false,loading:a,eventAfterRender:e,eventRender:e,eventColor:"#576B6B",defaultView:"month"})})}).call(this);