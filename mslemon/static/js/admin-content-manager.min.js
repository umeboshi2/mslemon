(function(){var b={}.hasOwnProperty,c=function(g,e){for(var d in e){if(b.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f();g.__super__=e.prototype;return g},a=function(d,e){return function(){return d.apply(e,arguments)}};jQuery(function(){var f,v,H,F,y,D,A,s,n,u,l,z,q,x,C,r,B,w,k,t,p,h,e,L,J,G,E,o,m,j,i,g,d,K,I;w=function(N,M){return make_alert("Succesful Transfer","success")};B=function(N,M){return make_alert("Error in Transfer","error")};k=function(){return{path:q,tmpl:r,css:A,js:u}};window.lviews=k;H=(function(N){c(M,N);function M(){t=M.__super__.constructor.apply(this,arguments);return t}M.prototype.routes={"":"home","view/:listview":"listview"};M.prototype.common=function(){side_view.render();if(side_view.current_view!==null){return side_view.current_view.remove()}};M.prototype.home=function(){return this.common()};M.prototype.listview=function(P){var O,Q;this.common();O=k()[P];Q=new O;Q.render({type:P});return side_view.current_view=Q};return M})(Backbone.Router);l=(function(N){c(M,N);function M(){p=M.__super__.constructor.apply(this,arguments);return p}M.prototype.defaults={name:"",type:"path"};return M})(Backbone.Model);x=(function(M){c(N,M);function N(){o=N.__super__.constructor.apply(this,arguments);return o}N.prototype.defaults={name:"",content:"",type:"tmpl"};return N})(Backbone.Model);y=(function(M){c(N,M);function N(){m=N.__super__.constructor.apply(this,arguments);return m}N.prototype.defaults={name:"",content:"",type:"css"};return N})(Backbone.Model);s=(function(N){c(M,N);function M(){j=M.__super__.constructor.apply(this,arguments);return j}M.prototype.defaults={name:"",content:"",type:"js"};return M})(Backbone.Model);z=(function(N){c(M,N);function M(){i=M.__super__.constructor.apply(this,arguments);return i}M.prototype.model=l;M.prototype.url="/rest/sitepath";M.prototype.parse=function(O){return O.data};return M})(Backbone.Collection);C=(function(M){c(N,M);function N(){g=N.__super__.constructor.apply(this,arguments);return g}N.prototype.model=x;N.prototype.url="/rest/sitetmpl";N.prototype.parse=function(O){return O.data};return N})(Backbone.Collection);D=(function(M){c(N,M);function N(){d=N.__super__.constructor.apply(this,arguments);return d}N.prototype.model=y;N.prototype.url="/rest/sitecss";N.prototype.parse=function(O){return O.data};return N})(Backbone.Collection);n=(function(N){c(M,N);function M(){K=M.__super__.constructor.apply(this,arguments);return K}M.prototype.model=s;M.prototype.url="/rest/sitejs";M.prototype.parse=function(O){return O.data};return M})(Backbone.Collection);v=(function(M){c(N,M);function N(){I=N.__super__.constructor.apply(this,arguments);return I}N.prototype.template=TrumpetApp.admin_mgr_tmpl.entry_template;N.prototype.initialize=function(){_.bindAll(this,"render");this.model.bind("change",this.render);return this.model.bind("remove",this.unrender)};N.prototype.render=function(){var O;O=this.template.render(this.model.attributes);this.$el.html(O);return this};N.prototype.unrender=function(){return $(this.el).remove()};N.prototype.events={"click .show-entry-btn":"editme"};N.prototype.editme=function(){var S,R,Q,V,O,T,P,U=this;P=TrumpetApp.admin_mgr_tmpl.editor_template;Q=P.render(this.model.attributes);R=$(".listview-list");R.html(Q);O=$("#save-content");O.hide();O.click(function(){var W;U.model.set("content",S.getValue());W=U.model.save();W.done(function(){make_alert("Saved");return $("#save-content").hide()});return W.fail(function(){return make_alert("Failed to save model")})});S=ace.edit("editor");T=S.getSession();T.setValue(this.model.get("content"));T.on("change",function(){return $("#save-content").show()});V=this.model.get("type");if(V==="path"){R.html("SHOW ME")}else{if(V==="tmpl"){T.setMode("ace/mode/ejs")}else{if(V==="css"){T.setMode("ace/mode/css")}else{if(V==="js"){T.setMode("ace/mode/javascript")}else{R.html("Bad type"+V)}}}}S.setTheme("ace/theme/twilight");return this};return N})(Backbone.View);f=(function(N){c(M,N);function M(){this.appendItem=a(this.appendItem,this);h=M.__super__.constructor.apply(this,arguments);return h}M.prototype.el=$(".right-column-content");M.prototype.render=function(P){var O;O=TrumpetApp.admin_mgr_tmpl.listview_template;this.$el.html(O.render(P));return this};M.prototype.remove=function(){this.undelegateEvents();this.$el.empty();this.stopListening();return this};M.prototype.appendItem=function(P){var Q,O;O=new v({model:P});Q=O.render(P).el;return $(".listview-list").append(Q)};M.prototype.events={"click .add-entry-btn":"new_entry_view"};M.prototype.new_entry_view=function(){var P,Q,O;Q=this.collection.model;O=new Q();P="Make new Entry "+O.get("type");return $(".listview-list").html(P)};return M})(Backbone.View);q=(function(N){c(M,N);function M(){e=M.__super__.constructor.apply(this,arguments);return e}M.prototype.initialize=function(){console.log("Init SitePathListView");this.collection=new z;this.collection.bind("add",this.appendItem);return this.collection.fetch()};return M})(f);r=(function(N){c(M,N);function M(){L=M.__super__.constructor.apply(this,arguments);return L}M.prototype.initialize=function(){console.log("Init SiteTemplateListView");this.collection=new C;this.collection.bind("add",this.appendItem);return this.collection.fetch()};return M})(f);A=(function(N){c(M,N);function M(){J=M.__super__.constructor.apply(this,arguments);return J}M.prototype.initialize=function(){console.log("Init SiteCSSListView");this.collection=new D;this.collection.bind("add",this.appendItem);return this.collection.fetch()};return M})(f);u=(function(N){c(M,N);function M(){G=M.__super__.constructor.apply(this,arguments);return G}M.prototype.initialize=function(){console.log("Init SiteJSListView");this.collection=new n;this.collection.bind("add",this.appendItem);return this.collection.fetch()};return M})(f);F=(function(N){var O;c(M,N);function M(){E=M.__super__.constructor.apply(this,arguments);return E}M.prototype.el=$(".sidebar");M.prototype.initialize=function(){console.log("Init SideView");return this.current_view=null};M.prototype.template=TrumpetApp.admin_mgr_tmpl.side_view_template;M.prototype.render=function(){$(this.el).html(this.template.render());return this};O={trigger:true,replace:true};M.prototype.events={"click .home-button":function(){return main_router.navigate("",O)},"click .sitepaths-button":function(){$(".listview-list").remove();main_router.navigate("dummy",O);return main_router.navigate("view/path",O)},"click .sitetmpl-button":function(){$(".listview-list").remove();main_router.navigate("dummy",O);return main_router.navigate("view/tmpl",O)},"click .sitecss-button":function(){$(".listview-list").remove();main_router.navigate("dummy",O);return main_router.navigate("view/css",O)},"click .sitejs-button":function(){$(".listview-list").remove();main_router.navigate("dummy",O);return main_router.navigate("view/js",O)}};return M})(Backbone.View);window.main_router=new H;window.side_view=new F;return Backbone.history.start()})}).call(this);